<!doctype html>
<html class="no-js" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorator="layout/blayout" >
<div layout:fragment="content">
    <script th:src="@{/js/bussiness/bussiness-index.js}"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <link rel="stylesheet" th:href="@{/css/bussiness/index.css}" />
    <div class="bussiness-div">
        <div class="bussiness-top">
            <div class="bussiness-top-background"></div>
            <div class="bussiness-top-estimer">
                <div class="form-group bussiness-top-estimer-div">
                    <input name="address" class="form-control"
                           placeholder="房源地址"
                           id="autocomplete"
                           type="text"/>
                    <button class="btn btn-danger btn-estimation">免费估价</button>
                </div>
                <div style="color: whitesmoke;">
                    <h6>输入地址，系统将会给出近6年的整栋楼真实交易数据，免的卖低吃亏，或买高痛心!</h6>
                </div>
            </div>
            <div class="bussiness-top-annocne">
                <a class="btn btn-success" href="/bussiness/login">发布房源</a>
            </div>
            <div class="bussiness-top-map">
                <a class="btn btn-success" href="/site/bussiness/map">地图找房</a>
            </div>
        </div>
        <div class="bussiness-advance">
            <div class="bussiness-advance-title">
                <h3>开放、包容、多语言平台</h3>
                <div>欢迎个人及中介发布房源</div>
            </div>
            <div class="bussiness-advance-items">
                <div class="advance-item">
                    <h3><img th:src="@{/img/bussiness/express.png}"/> 12 年</h3>
                    <div>房地产成功经验</div>
                </div>

                <div class="advance-item">
                    <h3><img th:src="@{/img/bussiness/price.png}" /> 5000 €</h3>
                    <div>中介费，比传统中介便宜50%</div>
                </div>

                <div class="advance-item">
                    <h3><img th:src="@{/img/bussiness/brand.png}" /> 第 1</h3>
                    <div>华人房地产第一门户</div>
                    <div>买卖、租赁、房管、短租</div>
                </div>
            </div>
            <div style="text-align: right;padding: 20px;">
                <a href="/bussiness/platform">详情>></a>
            </div>
        </div>
        <div class="search-box">
            <div class="search-box-right">
                <div class="button-groups">
                    <div class="button-type button-active" data-id="0">二手房</div>
                    <div class="button-type" data-id="1">新房</div>
                    <div class="button-type" data-id="2">养老房</div>
                    <div class="button-type" data-id="3">商业地产</div>
                    <div class="button-type" data-id="4">地皮</div>
                </div>
                <div class="search-box-input">
                    <div class="form-group search-tilte"><h2>搜索您的需求</h2></div>
                    <div class="double-elements">
                        <div class="form-group search-item" style="margin-right: 30px;">
                            <label>区域</label>
                            <div>
                                <input name="location" class="form-control"/>
                            </div>
                        </div>
                        <div class="form-group search-item">
                            <label>预算</label>
                            <div>
                                <input name="budget" class="form-control" type="number"/>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <span>别墅</span>
                        <span>公寓</span>
                    </div>
                    <div class="form-group button-group">
                        <a class="btn btn-link">更多选项>>></a>
                    </div>
                    <div class="form-group button-group-center">
                        <button class="btn btn-danger" type="button">搜索</button>
                    </div>
                </div>
            </div>
            <div class="search-box-left"><img id="search-img" th:src="@{/img/bussiness/search.png}" /></div>
        </div>
<!--        <div class="">-->

<!--        </div>-->
        <div>
            <div class="house-div-title">
                <div class="house-div-title-item house-active" data-id="0">全部房源</div>
                <div class="house-div-title-item" data-id="1">自营房源</div>
                <div class="house-div-title-item" data-id="2">按需买房</div>
            </div>
            <div class="house-scroll select-div-item" data-id="0">

            </div>

            <div class="platform-house-scroll select-div-item" data-id="1">

            </div>

            <div class="buy-house-scroll select-div-item" data-id="2">

            </div>
        </div>

        <div class="bussiness-calculator">
            <div class="bussiness-calculator-content">
                <div class="bussiness-calculator-title">
                    <h2>省钱</h2>
                </div>
                <div class="bussiness-calculator-div">
                    <div class="calcu-title"><h3>销售价格</h3></div>
                    <div class="calcu-progress form-group">
                        <label>10 0000 €</label>
                        <input  value="0" min="100000" max="1000000" type="range" class="form-control-range" id="calcu-range"/>
                        <label>100 0000 €</label>
                    </div>
                    <div class="bussiness-calculator-compare form-group">
                        <div>
                            <div>你与普通中介的交易</div>
                            <div class="compare-item btn btn-info btn-lg" id="calcu-agents"></div>
                        </div>
                        <div>
                            <div>您与我们平台的交易</div>
                            <div class="compare-item btn btn-success btn-lg" id="calcu-paltform"></div>
                        </div>
                    </div>
                    <div class="form-group calcu-gar-div">
                        您将节省<label id="calcu-gar">0</label>€
                    </div>
                </div>
                <div class="bussiness-calcu-footer-title form-group">
                    <div>
                        *代理机构平均佣金4.87％（来源：<a href="https://www.lesechos.fr/2017/11/immobilier-quels-honoraires-pratiquent-les-agences-186509">Galian担保基金研究</a>）
                    </div>
                    <div>
                        ** 平台优惠佣金990€卖方费用
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
            let placeSearch;
            let autocomplete;
            let params = [];
            const componentForm = {
                street_number: "short_name",
                route: "long_name",
                locality: "long_name",
                administrative_area_level_1: "short_name",
                country: "long_name",
                postal_code: "short_name",
            };

            function initAutocomplete() {
                // Create the autocomplete object, restricting the search predictions to
                // geographical location types.
                autocomplete = new google.maps.places.Autocomplete(
                    document.getElementById("autocomplete"),
                    { types: ["geocode"] }
                );
                // Avoid paying for data that you don't need by restricting the set of
                // place fields that are returned to just the address components.
                autocomplete.setFields(["address_component"]);
                // When the user selects an address from the drop-down, populate the
                // address fields in the form.
                autocomplete.addListener("place_changed", fillInAddress);
            }

            function fillInAddress() {
                // Get the place details from the autocomplete object.
                const place = autocomplete.getPlace();
                params["street_number"] = place.address_components[0].short_name;
                params["route"] = place.address_components[1].short_name;
                params["postcode"] = place.address_components[6].short_name;
            }

            // Bias the autocomplete object to the user's geographical location,
            // as supplied by the browser's 'navigator.geolocation' object.
            function geolocate() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition((position) => {
                        const geolocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude,
                        };
                        const circle = new google.maps.Circle({
                            center: geolocation,
                            radius: position.coords.accuracy,
                        });
                        autocomplete.setBounds(circle.getBounds());
                    });
                }
            }

            $("#autocomplete").focus(geolocate);

            $(".btn-estimation").click(function () {
                let urlParam = "";
                if (params["street_number"]){
                    urlParam += "street_number="+params["street_number"];
                }

                if (params["route"]){
                    urlParam += "&route="+params["route"];
                }

                if (params["postcode"]){
                    urlParam += "&postcode="+params["postcode"];
                }

                if (urlParam){
                    window.location.assign("/bussiness/estimation?"+urlParam);
                }else{
                    window.location.assign("/bussiness/estimation");
                }
            });

    </script>
    <script
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB7nEtarhZDOZBUnGgWT4r91yH4koXBjFs&callback=initAutocomplete&libraries=places&v=weekly"
            async
    ></script>
</div>
</html>